### Description of the databases [here](<../Week_01/movie_pc_ships.pdf/>)

### Scripts of the databases [here](<../Week_01/Scripts/>)

# Упражнение 2 - Заявки върху 2 или повече релации



## CROSS JOIN - съединение


Нека са дадени 2 таблици: *Table1* и *Тable2*

За *Table1* имаме `n` атрибута и `j` кортежи

За *Table2* имаме `m` атрибута и `i` кортежи

Тогава резултатната таблица на Table1 **CROSS JOIN** Table2 ще:

- има `m + n` атрибута
- има `i * j` кортежи


Тоест ще се създаде резултатна таблица, която комбинира всеки ред на първата таблица с всеки ред на втората, а атрибутите ще са обединени.


##### **!** Запетаята се подразбира като CROSS JOIN


*Пример:*

```sql
  SELECT

  FROM TABLE1, TABLE2
```


#### Дублиране на имена

При еднакви имена на атрибити в две отделни таблици за пояснение използваме `.`


*Пример:*

```sql
SELECT MOVIEEXEC.NAME, MOVIE.NAME
```


## Вътрешно съединение по условие (Тита съединение)

```sql
SELECT MOVIEEXEC.NAME

FROM MOVIE (INNER) JOIN MOVIEEXEC   --по default e inner

  ON PRODC = CERT

WHERE MOVIE.NAME = 'M1' ;
```


##### Можем да chain-ваме съединяванията на таблиците като:

```sql
T1 JOIN T2

  ON T1.A = T2.A

JOIN T3     --(резултатът от горното съединение ще се съедини с T3)

  ON T1.A = T3.A
```


##### Eквивалентен на резултата от INNER JOIN e следния CROSS JOIN

```sql
FROM MOVIE, MOVIEEXEC

WHERE PRODC = CERT

  AND MOVIE.NAME = 'M1' ;
```

Разликата е съответно, че първо ще се комбинира всяко с всяко и после ще се приложат условията



## Множествени операции върху таблици


- #### UNION 

  UNION е еквивалентен на операцията **обединение**

  Важно е да се отбележи, че броят на атрибитите трябва да съвпада в двете таблици и типа на данните да е съвместим

  ( примерно 'число с число', 'string със string' )


  **UNION** по default отсранява повтарящите се кортежи

  **UNION ALL** запазва повтарящите се кортежи



- #### INTERSECT

  Еквивалентен на операцията **съедиение**. Запазва общите кортежи в двете таблици



- #### EXCEPT

  Еквивалентен на операцията **разлика**. Съответно T1 EXCEPT T2: Премахва кортежите на T2 от Т1



Ако извършваме множествени операции върху 2 отделни заявки се забранява използването на **ORDER BY** след индивидуална заявка. 

Поставя се накрая след заявките



#### Ред на изпълнение на множествени операции


*Примерно:*

```sql
  q1

  UNION   -- ще се изпълни 2-ро

  q2

  EXCEPT -- ще се изпълни 3-то 

  q3

  INTERSECT -- ще се изпълни 1-во 

  q4
```
, където `q1, q2, q3, q4` са заявки

Чрез скоби `( )` може да се промени подредбата.
